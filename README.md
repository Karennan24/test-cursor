# 绩效提成核算系统

一个用于教育机构绩效提成核算的数据处理与分析系统，支持数据上传、校验、编辑、多维度分析和可视化展示。

## 功能特性

### 📤 数据上传与预览
- **拖拽上传**：支持拖放文件上传
- **多格式支持**：Excel (.xlsx, .xls) 和 CSV 格式
- **实时预览**：上传后立即预览数据
- **数据统计**：显示总行数、问题数等统计信息
- **字段筛选**：可折叠的字段选择器，支持自定义显示列

### ✅ 数据校验
- **自动校验**：上传后自动检测数据问题
- **问题高亮**：问题数据行高亮显示
- **详细说明**：提供问题类型和位置说明
- **问题导出**：支持导出问题数据

### ✏️ 数据编辑
- **内联编辑**：直接在预览表格中编辑数据
- **修改确认**：修改后弹出确认对话框
- **再次核查**：修改后可重新验证数据
- **状态跟踪**：实时跟踪编辑状态

### 📊 数据分析
- **多维度分析**：
  - 概览分析：关键指标、业务概况、核心建议
  - 财务分析：季度营收、趋势分析、退费率分析
  - 营销分析：学科分析、班型分析、学生类型分析
  - 销售分析：销售人员绩效分析
- **可视化图表**：
  - 趋势图（支持移动平均线）
  - 柱状图
  - 饼图
  - 分组柱状图
- **智能筛选**：
  - 时间范围筛选（支持快捷选择）
  - 多维度筛选（季度、学科、班型、学生类型）
  - 实时更新图表

### 📥 数据导出
- **问题数据导出**：导出有问题的数据
- **全部正确数据导出**：导出验证通过的数据
- **格式支持**：Excel 和 CSV 格式

## 技术栈

- **前端**：HTML5 + CSS3 + JavaScript (ES6+)
- **数据处理**：SheetJS (xlsx.js)
- **文件导出**：FileSaver.js
- **数据存储**：localStorage
- **图表绘制**：Canvas API

## 项目结构

```
test1--cursor/
├── index.html          # 首页
├── upload.html         # 上传与预览页面
├── analysis.html       # 数据分析页面
├── css/
│   └── styles.css      # 样式文件
├── js/
│   ├── app.js          # 上传页面逻辑
│   ├── validation.js   # 数据校验逻辑
│   └── analysis.js     # 数据分析逻辑
└── vendor/             # 第三方库（可选）
```

## 使用说明

### 1. 数据上传
1. 打开 `upload.html`
2. 上传营收表和退费表（支持拖拽或点击选择）
3. 系统自动校验数据并显示问题

### 2. 数据编辑（可选）
1. 点击"启用编辑"按钮
2. 在表格中直接修改数据
3. 点击"确认修改"保存
4. 点击"再次数据核查"重新验证

### 3. 数据分析
1. 确保数据验证通过
2. 点击"数据可用后进入分析"
3. 在分析页面查看多维度分析报告
4. 使用筛选功能查看不同维度的数据

### 4. 数据导出
- 导出问题数据：查看和修复问题
- 导出全部正确数据：用于后续处理

## 开发迭代

本项目经过约20次迭代优化，包括：
- 基础功能实现
- 上传功能优化（拖拽、进度条）
- 分析维度扩展
- 智能分析报告
- UI/UX优化
- 筛选功能实现
- 性能优化
- 编辑功能添加
- 稳定性修复

## 浏览器兼容性

- Chrome 90+
- Firefox 88+
- Edge 90+
- Safari 14+

## 数据安全

- 所有数据处理在本地完成
- 数据存储在浏览器 localStorage
- AI分析功能可选，需要用户明确授权
- 支持数据脱敏处理

## 许可证

MIT License

## 作者

Karennan24

